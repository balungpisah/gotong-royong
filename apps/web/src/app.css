@import url('https://fonts.googleapis.com/css2?family=Caveat:wght@400;500;600&family=Nunito:wght@400;600;700;800&display=swap');
@import 'tailwindcss';
@import 'tw-animate-css';

@custom-variant dark (&:is(.dark *));

:root {
	/* Tanah Inti */
	--c-tanah-gelap: #3e2723;
	--c-tanah: #5d4037;
	--c-kayu: #8d6e63;
	--c-pasir: #a1887f;
	--c-batu: #d7ccc8;
	--c-kapas: #f5ede3;
	--c-susu: #fffbf5;

	/* Aksi (Api) */
	--c-api: #c05621;
	--c-api-terang: #d2691e;
	--c-api-dalam: #a0461a;
	--c-bara: #fff3e0;

	/* Semantik */
	--c-berhasil: #2e7d32;
	--c-berhasil-lembut: #e8f5e9;
	--c-peringatan: #e65100;
	--c-peringatan-lembut: #fff3e0;
	--c-bahaya: #c62828;
	--c-bahaya-lembut: #ffebee;
	--c-keterangan: #4e342e;
	--c-keterangan-lembut: #efebe9;

	/* Track Accents */
	--t-tuntaskan: #c05621;
	--t-tuntaskan-soft: #fff3e0;
	--t-tuntaskan-muted: #ffecd2;
	--t-wujudkan: #2e7d32;
	--t-wujudkan-soft: #e8f5e9;
	--t-wujudkan-muted: #c8e6c9;
	--t-telusuri: #6a1b9a;
	--t-telusuri-soft: #f3e5f5;
	--t-telusuri-muted: #e1bee7;
	--t-rayakan: #f57f17;
	--t-rayakan-soft: #fff8e1;
	--t-rayakan-muted: #ffecb3;
	--t-musyawarah: #4e342e;
	--t-musyawarah-soft: #efebe9;
	--t-musyawarah-muted: #d7ccc8;

	/* Vault */
	--v-deep: #263238;
	--v-surface: #37474f;
	--v-mid: #546e7a;
	--v-soft: #78909c;
	--v-light: #b0bec5;
	--v-wash: #eceff1;

	/* Siaga */
	--s-deep: #b71c1c;
	--s-pulse: #d32f2f;
	--s-accent: #ff5252;
	--s-soft: #ffebee;
	--s-border: #ffcdd2;

	/* Tandang */
	--c-tandang: #00695c;
	--c-tandang-i: #f57f17;
	--c-tandang-c: #00695c;
	--c-tandang-j: #7b1fa2;

	/* Typography */
	--font-family: 'Nunito', -apple-system, sans-serif;
	--fs-display: 32px;
	--fs-h1: 26px;
	--fs-h2: 20px;
	--fs-h3: 16px;
	--fs-body: 14px;
	--fs-small: 12px;
	--fs-caption: 11px;
	--fs-micro: 9px;
	--lh-tight: 1.2;
	--lh-normal: 1.5;
	--lh-relaxed: 1.7;
	--fw-regular: 400;
	--fw-semi: 600;
	--fw-bold: 700;
	--fw-extra: 800;

	/* Spacing */
	--sp-1: 4px;
	--sp-2: 8px;
	--sp-3: 12px;
	--sp-4: 16px;
	--sp-5: 20px;
	--sp-6: 24px;
	--sp-8: 32px;
	--sp-10: 40px;
	--sp-12: 48px;
	--sp-16: 64px;

	/* Radius */
	--r-sm: 6px;
	--r-md: 10px;
	--r-lg: 14px;
	--r-xl: 20px;
	--r-full: 9999px;

	/* Brown-tinted shadows */
	--shadow-sm: 0 1px 4px rgba(62, 39, 35, 0.06);
	--shadow-md: 0 2px 12px rgba(62, 39, 35, 0.08);
	--shadow-lg: 0 4px 24px rgba(62, 39, 35, 0.12);
	--shadow-xl: 0 8px 40px rgba(62, 39, 35, 0.16);

	/* ─── Motion tokens ─── */
	--ease-spring: cubic-bezier(0.22, 1, 0.36, 1);
	--ease-smooth: cubic-bezier(0.25, 0.1, 0.25, 1);
	--ease-bounce: cubic-bezier(0.34, 1.56, 0.64, 1);
	--ease-snappy: cubic-bezier(0.2, 0, 0, 1);

	--dur-instant: 100ms;
	--dur-fast: 150ms;
	--dur-normal: 250ms;
	--dur-slow: 400ms;
	--dur-slower: 600ms;

	--stagger-gap: 50ms;

	/* shadcn semantic bridge */
	--radius: var(--r-md);
	--background: var(--c-kapas);
	--foreground: var(--c-tanah-gelap);
	--card: var(--c-susu);
	--card-foreground: var(--c-tanah-gelap);
	--popover: var(--c-susu);
	--popover-foreground: var(--c-tanah-gelap);
	--primary: var(--c-api);
	--primary-foreground: var(--c-susu);
	--secondary: var(--c-kapas);
	--secondary-foreground: var(--c-tanah-gelap);
	--muted: var(--c-kapas);
	--muted-foreground: var(--c-kayu);
	--accent: var(--c-bara);
	--accent-foreground: var(--c-api-dalam);
	--destructive: var(--c-bahaya);
	--border: var(--c-batu);
	--input: var(--c-kapas);
	--ring: var(--c-api-terang);
	--chart-1: var(--t-tuntaskan);
	--chart-2: var(--t-wujudkan);
	--chart-3: var(--t-telusuri);
	--chart-4: var(--t-rayakan);
	--chart-5: var(--t-musyawarah);
	--sidebar: var(--c-kapas);
	--sidebar-foreground: var(--c-tanah-gelap);
	--sidebar-primary: var(--c-api);
	--sidebar-primary-foreground: var(--c-susu);
	--sidebar-accent: var(--c-bara);
	--sidebar-accent-foreground: var(--c-api-dalam);
	--sidebar-border: var(--c-batu);
	--sidebar-ring: var(--c-api-terang);
}

.dark {
	--background: var(--v-deep);
	--foreground: var(--c-susu);
	--card: var(--v-surface);
	--card-foreground: var(--c-susu);
	--popover: var(--v-surface);
	--popover-foreground: var(--c-susu);
	--primary: var(--c-api-terang);
	--primary-foreground: var(--c-susu);
	--secondary: var(--v-mid);
	--secondary-foreground: var(--c-susu);
	--muted: var(--v-mid);
	--muted-foreground: var(--v-light);
	--accent: var(--v-soft);
	--accent-foreground: var(--c-susu);
	--destructive: var(--s-accent);
	--border: color-mix(in srgb, var(--v-light) 24%, transparent);
	--input: color-mix(in srgb, var(--v-light) 20%, transparent);
	--ring: var(--c-api-terang);
	--sidebar: var(--v-surface);
	--sidebar-foreground: var(--c-susu);
	--sidebar-primary: var(--c-api-terang);
	--sidebar-primary-foreground: var(--c-susu);
	--sidebar-accent: var(--v-mid);
	--sidebar-accent-foreground: var(--c-susu);
	--sidebar-border: color-mix(in srgb, var(--v-light) 24%, transparent);
	--sidebar-ring: var(--c-api-terang);
}

@theme inline {
	--font-sans: var(--font-family);
	--radius-sm: calc(var(--radius) - 4px);
	--radius-md: calc(var(--radius) - 2px);
	--radius-lg: var(--radius);
	--radius-xl: calc(var(--radius) + 4px);
	--radius-full: var(--r-full);
	--shadow-sm: var(--shadow-sm);
	--shadow-md: var(--shadow-md);
	--shadow-lg: var(--shadow-lg);
	--shadow-xl: var(--shadow-xl);

	/* shadcn semantic colors */
	--color-background: var(--background);
	--color-foreground: var(--foreground);
	--color-card: var(--card);
	--color-card-foreground: var(--card-foreground);
	--color-popover: var(--popover);
	--color-popover-foreground: var(--popover-foreground);
	--color-primary: var(--primary);
	--color-primary-foreground: var(--primary-foreground);
	--color-secondary: var(--secondary);
	--color-secondary-foreground: var(--secondary-foreground);
	--color-muted: var(--muted);
	--color-muted-foreground: var(--muted-foreground);
	--color-accent: var(--accent);
	--color-accent-foreground: var(--accent-foreground);
	--color-destructive: var(--destructive);
	--color-border: var(--border);
	--color-input: var(--input);
	--color-ring: var(--ring);
	--color-chart-1: var(--chart-1);
	--color-chart-2: var(--chart-2);
	--color-chart-3: var(--chart-3);
	--color-chart-4: var(--chart-4);
	--color-chart-5: var(--chart-5);
	--color-sidebar: var(--sidebar);
	--color-sidebar-foreground: var(--sidebar-foreground);
	--color-sidebar-primary: var(--sidebar-primary);
	--color-sidebar-primary-foreground: var(--sidebar-primary-foreground);
	--color-sidebar-accent: var(--sidebar-accent);
	--color-sidebar-accent-foreground: var(--sidebar-accent-foreground);
	--color-sidebar-border: var(--sidebar-border);
	--color-sidebar-ring: var(--sidebar-ring);

	/* Design DNA direct tokens */
	--color-tanah-gelap: var(--c-tanah-gelap);
	--color-tanah: var(--c-tanah);
	--color-kayu: var(--c-kayu);
	--color-pasir: var(--c-pasir);
	--color-batu: var(--c-batu);
	--color-kapas: var(--c-kapas);
	--color-susu: var(--c-susu);
	--color-api: var(--c-api);
	--color-api-terang: var(--c-api-terang);
	--color-api-dalam: var(--c-api-dalam);
	--color-bara: var(--c-bara);
	--color-berhasil: var(--c-berhasil);
	--color-berhasil-lembut: var(--c-berhasil-lembut);
	--color-peringatan: var(--c-peringatan);
	--color-peringatan-lembut: var(--c-peringatan-lembut);
	--color-bahaya: var(--c-bahaya);
	--color-bahaya-lembut: var(--c-bahaya-lembut);
	--color-keterangan: var(--c-keterangan);
	--color-keterangan-lembut: var(--c-keterangan-lembut);
	--color-tuntaskan: var(--t-tuntaskan);
	--color-tuntaskan-soft: var(--t-tuntaskan-soft);
	--color-tuntaskan-muted: var(--t-tuntaskan-muted);
	--color-wujudkan: var(--t-wujudkan);
	--color-wujudkan-soft: var(--t-wujudkan-soft);
	--color-wujudkan-muted: var(--t-wujudkan-muted);
	--color-telusuri: var(--t-telusuri);
	--color-telusuri-soft: var(--t-telusuri-soft);
	--color-telusuri-muted: var(--t-telusuri-muted);
	--color-rayakan: var(--t-rayakan);
	--color-rayakan-soft: var(--t-rayakan-soft);
	--color-rayakan-muted: var(--t-rayakan-muted);
	--color-musyawarah: var(--t-musyawarah);
	--color-musyawarah-soft: var(--t-musyawarah-soft);
	--color-musyawarah-muted: var(--t-musyawarah-muted);
	--color-vault-deep: var(--v-deep);
	--color-vault-surface: var(--v-surface);
	--color-vault-mid: var(--v-mid);
	--color-vault-soft: var(--v-soft);
	--color-vault-light: var(--v-light);
	--color-vault-wash: var(--v-wash);
	--color-siaga-deep: var(--s-deep);
	--color-siaga-pulse: var(--s-pulse);
	--color-siaga-accent: var(--s-accent);
	--color-siaga-soft: var(--s-soft);
	--color-siaga-border: var(--s-border);
	--color-tandang: var(--c-tandang);
	--color-tandang-i: var(--c-tandang-i);
	--color-tandang-c: var(--c-tandang-c);
	--color-tandang-j: var(--c-tandang-j);

	--spacing-1: var(--sp-1);
	--spacing-2: var(--sp-2);
	--spacing-3: var(--sp-3);
	--spacing-4: var(--sp-4);
	--spacing-5: var(--sp-5);
	--spacing-6: var(--sp-6);
	--spacing-8: var(--sp-8);
	--spacing-10: var(--sp-10);
	--spacing-12: var(--sp-12);
	--spacing-16: var(--sp-16);

	/* Motion tokens for Tailwind */
	--ease-spring: var(--ease-spring);
	--ease-smooth: var(--ease-smooth);
	--ease-bounce: var(--ease-bounce);
	--ease-snappy: var(--ease-snappy);
	--transition-timing-function-spring: var(--ease-spring);
	--transition-timing-function-smooth: var(--ease-smooth);
	--transition-timing-function-bounce: var(--ease-bounce);
	--transition-timing-function-snappy: var(--ease-snappy);
}

/* ─────────────────────────────────────────────────────────────────────────────
 * Animation Foundation — reusable motion utilities
 *
 * Usage:  class="animate-fade-in"  or  class="animate-slide-up"
 * Stagger: class="animate-fade-in [animation-delay:var(--stagger-gap)]"
 *          or use the stagger utilities: class="stagger-1 animate-fade-in"
 * ───────────────────────────────────────────────────────────────────────────── */

/* ── Existing ── */

@utility animate-blink {
	animation: blink 1.5s ease-in-out infinite;
}

/* ── Fade ── */

@utility animate-fade-in {
	animation: fade-in var(--dur-normal) var(--ease-smooth) both;
}

@utility animate-fade-out {
	animation: fade-out var(--dur-fast) var(--ease-smooth) both;
}

/* ── Slide ── */

@utility animate-slide-up {
	animation: slide-up var(--dur-normal) var(--ease-spring) both;
}

@utility animate-slide-down {
	animation: slide-down var(--dur-normal) var(--ease-spring) both;
}

@utility animate-slide-left {
	animation: slide-left var(--dur-normal) var(--ease-spring) both;
}

@utility animate-slide-right {
	animation: slide-right var(--dur-normal) var(--ease-spring) both;
}

/* ── Scale ── */

@utility animate-scale-in {
	animation: scale-in var(--dur-normal) var(--ease-bounce) both;
}

@utility animate-scale-out {
	animation: scale-out var(--dur-fast) var(--ease-smooth) both;
}

/* ── Expand / Collapse (for panels, drawers, accordions) ── */

@utility animate-expand {
	animation: expand var(--dur-slow) var(--ease-spring) both;
}

@utility animate-collapse {
	animation: collapse var(--dur-normal) var(--ease-smooth) both;
}

/* ── Float (subtle idle movement — "alive" feel) ── */

@utility animate-float {
	animation: float 3s var(--ease-smooth) infinite;
}

@utility animate-pulse-soft {
	animation: pulse-soft 2s var(--ease-smooth) infinite;
}

/* ── Pulse Glow — breathing shadow for "alive" cards (Phase 1 Engagement) ── */

@utility animate-pulse-glow {
	animation: pulse-glow 2.4s var(--ease-smooth) infinite;
}

/* ── Stagger delay utilities ── */

@utility stagger-1 {
	animation-delay: calc(var(--stagger-gap) * 1);
}
@utility stagger-2 {
	animation-delay: calc(var(--stagger-gap) * 2);
}
@utility stagger-3 {
	animation-delay: calc(var(--stagger-gap) * 3);
}
@utility stagger-4 {
	animation-delay: calc(var(--stagger-gap) * 4);
}
@utility stagger-5 {
	animation-delay: calc(var(--stagger-gap) * 5);
}
@utility stagger-6 {
	animation-delay: calc(var(--stagger-gap) * 6);
}
@utility stagger-7 {
	animation-delay: calc(var(--stagger-gap) * 7);
}
@utility stagger-8 {
	animation-delay: calc(var(--stagger-gap) * 8);
}

/* ── Duration modifiers ── */

@utility motion-instant {
	animation-duration: var(--dur-instant);
}
@utility motion-fast {
	animation-duration: var(--dur-fast);
}
@utility motion-normal {
	animation-duration: var(--dur-normal);
}
@utility motion-slow {
	animation-duration: var(--dur-slow);
}
@utility motion-slower {
	animation-duration: var(--dur-slower);
}

/* ── Easing modifiers ── */

@utility motion-spring {
	animation-timing-function: var(--ease-spring);
}
@utility motion-smooth {
	animation-timing-function: var(--ease-smooth);
}
@utility motion-bounce {
	animation-timing-function: var(--ease-bounce);
}
@utility motion-snappy {
	animation-timing-function: var(--ease-snappy);
}

/* ═══════════════════════════════════════════════════════════════════════════
 * Keyframes
 * ═══════════════════════════════════════════════════════════════════════════ */

@keyframes blink {
	0%,
	100% {
		opacity: 1;
	}
	50% {
		opacity: 0.3;
	}
}

@keyframes fade-in {
	from {
		opacity: 0;
	}
	to {
		opacity: 1;
	}
}

@keyframes fade-out {
	from {
		opacity: 1;
	}
	to {
		opacity: 0;
	}
}

@keyframes slide-up {
	from {
		opacity: 0;
		transform: translateY(12px);
	}
	to {
		opacity: 1;
		transform: translateY(0);
	}
}

@keyframes slide-down {
	from {
		opacity: 0;
		transform: translateY(-12px);
	}
	to {
		opacity: 1;
		transform: translateY(0);
	}
}

@keyframes slide-left {
	from {
		opacity: 0;
		transform: translateX(12px);
	}
	to {
		opacity: 1;
		transform: translateX(0);
	}
}

@keyframes slide-right {
	from {
		opacity: 0;
		transform: translateX(-12px);
	}
	to {
		opacity: 1;
		transform: translateX(0);
	}
}

@keyframes scale-in {
	from {
		opacity: 0;
		transform: scale(0.92);
	}
	to {
		opacity: 1;
		transform: scale(1);
	}
}

@keyframes scale-out {
	from {
		opacity: 1;
		transform: scale(1);
	}
	to {
		opacity: 0;
		transform: scale(0.92);
	}
}

@keyframes expand {
	from {
		opacity: 0;
		transform: scaleY(0);
		transform-origin: top;
	}
	to {
		opacity: 1;
		transform: scaleY(1);
		transform-origin: top;
	}
}

@keyframes collapse {
	from {
		opacity: 1;
		transform: scaleY(1);
		transform-origin: top;
	}
	to {
		opacity: 0;
		transform: scaleY(0);
		transform-origin: top;
	}
}

@keyframes float {
	0%,
	100% {
		transform: translateY(0);
	}
	50% {
		transform: translateY(-4px);
	}
}

@keyframes pulse-soft {
	0%,
	100% {
		opacity: 1;
	}
	50% {
		opacity: 0.7;
	}
}

/* Pulse Glow — breathing shadow expansion for "alive" feed cards.
 * The --pulse-color CSS var is set inline by the card component
 * (derived from sentiment/track color). The shadow expands and
 * contracts — a visible heartbeat that says "something is happening."
 *
 * V4 refined: gentle but perceptible.
 * Resting: tight, subtle glow (12%/15%).
 * Peak: soft glow (20%/28%) + no vertical lift.
 * The spread difference (8px → 16px) creates a calm "breathing" feel. */
@keyframes pulse-glow {
	0%,
	100% {
		box-shadow:
			0 1px 3px 0 color-mix(in srgb, var(--pulse-color, var(--c-api)) 12%, transparent),
			0 2px 8px -1px color-mix(in srgb, var(--pulse-color, var(--c-api)) 15%, transparent);
	}
	50% {
		box-shadow:
			0 2px 8px 1px color-mix(in srgb, var(--pulse-color, var(--c-api)) 20%, transparent),
			0 4px 16px -2px color-mix(in srgb, var(--pulse-color, var(--c-api)) 28%, transparent);
	}
}

/* Story Peek — continuous smooth scroll ticker.
 * The strip contains all messages × 2 (duplicated for seamless wrap).
 * CSS animation scrolls -50% at constant linear speed, then loops.
 * Duration set inline: messages.length × 4s.
 * 3-line window (54px) — long messages naturally get more reading time
 * because they take up more vertical space in the strip. */

.peek-scroll {
	will-change: transform;
	animation: peek-scroll-up linear infinite;
}

.peek-scroll:hover {
	animation-play-state: paused;
}

@keyframes peek-scroll-up {
	from { transform: translateY(0); }
	to   { transform: translateY(-50%); }
}

/* ═══════════════════════════════════════════════════════════════════════════
 * Accessibility — respect user motion preferences
 * ═══════════════════════════════════════════════════════════════════════════ */

@media (prefers-reduced-motion: reduce) {
	*,
	*::before,
	*::after {
		animation-duration: 0.01ms !important;
		animation-iteration-count: 1 !important;
		transition-duration: 0.01ms !important;
		scroll-behavior: auto !important;
	}
}

/* ═══════════════════════════════════════════════════════════════════════════
 * Base layer
 * ═══════════════════════════════════════════════════════════════════════════ */

@layer base {
	* {
		@apply border-border outline-ring/50;
	}

	html,
	body {
		font-family: var(--font-family);
		background-color: var(--background);
		color: var(--foreground);
		line-height: var(--lh-normal);
	}

	/* Always reserve scrollbar space so layout never shifts when
	   content height changes (e.g. context box open/close). */
	html {
		scrollbar-gutter: stable;
	}

	/* ── Quadrille paper background ─────────────────────────────
	 * Faint grid texture on the app background — gives a sense
	 * of surface & cohesion instead of flat emptiness.
	 * Applied via .quadrille-bg utility on the app-shell wrapper
	 * (not body — child divs with bg-background would cover it).
	 * Uses the earthy brown palette (tanah-gelap #3e2723) so
	 * the grid feels warm and natural.
	 * ────────────────────────────────────────────────────────── */
	.quadrille-bg {
		--grid-color: rgba(62, 39, 35, 0.10);
		background-image:
			linear-gradient(var(--grid-color) 1px, transparent 1px),
			linear-gradient(90deg, var(--grid-color) 1px, transparent 1px);
		background-size: 24px 24px;
	}

	/* Dark mode: use vault-light (#b0bec5) tinted grid */
	:is(.dark) .quadrille-bg {
		--grid-color: rgba(176, 190, 197, 0.10);
	}
}
