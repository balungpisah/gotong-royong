{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://gotong-royong.internal/schema/edgepod-endpoint-contracts.schema.json",
  "title": "Gotong-Royong -> Edge-Pod endpoint contract bundle",
  "definitions": {
    "Actor": {
      "type": "object",
      "required": ["user_id", "platform_user_id", "role"],
      "properties": {
        "user_id": { "type": "string", "minLength": 1 },
        "platform_user_id": { "type": "string", "minLength": 1 },
        "role": {
          "type": "string",
          "enum": ["member", "admin", "moderator", "humas", "bendahara", "pic", "system"]
        }
      },
      "additionalProperties": false
    },
    "GeoPoint": {
      "type": "object",
      "required": ["lat", "lng"],
      "properties": {
        "lat": { "type": "number", "minimum": -90, "maximum": 90 },
        "lng": { "type": "number", "minimum": -180, "maximum": 180 }
      },
      "additionalProperties": true
    },
    "BaseRequest": {
      "type": "object",
      "required": ["request_id", "correlation_id", "actor", "trigger", "payload_version"],
      "properties": {
        "request_id": {
          "type": "string",
          "pattern": "^req_[A-Za-z0-9_-]{8,}$"
        },
        "correlation_id": { "type": "string", "minLength": 4 },
        "actor": { "$ref": "#/definitions/Actor" },
        "session_id": { "type": "string" },
        "trigger": {
          "type": "string",
          "enum": ["user_action", "timer", "webhook", "async_batch"]
        },
        "payload_version": { "type": "string" },
        "privacy_level": {
          "type": "string",
          "enum": ["open", "l1", "l2", "vault"]
        }
      },
      "additionalProperties": true
    },
    "SuccessEnvelope": {
      "type": "object",
      "required": ["request_id", "result_version", "output"],
      "properties": {
        "request_id": { "type": "string", "minLength": 1 },
        "result_version": { "type": "string", "pattern": "^v\\d+\\.\\d+\\.\\d+$" },
        "output": { "type": "object" },
        "confidence": { "type": "number", "minimum": 0, "maximum": 1 },
        "reason_code": { "type": "string" },
        "actor_context": { "type": "object", "additionalProperties": true }
      },
      "additionalProperties": true
    },
    "ErrorEnvelope": {
      "type": "object",
      "required": ["request_id", "result_version", "error"],
      "properties": {
        "request_id": { "type": "string", "minLength": 1 },
        "result_version": { "type": "string", "pattern": "^v\\d+\\.\\d+\\.\\d+$" },
        "error": {
          "type": "object",
          "required": ["code", "message", "retryable"],
          "properties": {
            "code": {
              "type": "string",
              "enum": [
                "MODEL_UNAVAILABLE",
                "INVALID_INPUT",
                "TIMEOUT",
                "SCHEMA_VIOLATION",
                "RETRYABLE_TRANSIENT",
                "POLICY_BLOCK"
              ]
            },
            "message": { "type": "string", "minLength": 1 },
            "retryable": { "type": "boolean" },
            "details": { "type": "object", "additionalProperties": true }
          },
          "additionalProperties": true
        }
      },
      "additionalProperties": true
    }
  },
  "endpoints": {
    "EP-00": {
      "path": "/api/v1/edge-pod/ai/00/triage",
      "method": "POST",
      "request_schema": {
        "allOf": [
          { "$ref": "#/definitions/BaseRequest" },
          {
            "type": "object",
            "required": ["text"],
            "properties": {
              "text": { "type": "string", "minLength": 1 },
              "media_urls": {
                "type": "array",
                "items": { "type": "string", "format": "uri" }
              },
              "location": { "$ref": "#/definitions/GeoPoint" },
              "voice_transcript": { "type": "string" },
              "attachments_count": { "type": "integer", "minimum": 0, "maximum": 5 },
              "privacy_signal": { "type": "string" },
              "rencana_rutin": { "type": "boolean" }
            }
          }
        ]
      },
      "success_response_schema": {
        "allOf": [
          { "$ref": "#/definitions/SuccessEnvelope" },
          {
            "required": ["output"],
            "properties": {
              "output": {
                "type": "object",
                "required": [
                  "entry_flow",
                  "track",
                  "seed_type",
                  "context_bar_state",
                  "is_split_candidate"
                ],
                "properties": {
                  "entry_flow": {
                    "type": "string",
                    "enum": ["community", "vault", "siaga"]
                  },
                  "track": { "type": "string" },
                  "seed_type": { "type": "string" },
                  "context_bar_state": { "type": "string" },
                  "is_split_candidate": { "type": "boolean" },
                  "split_candidates": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "required": ["seed_id", "reason"],
                      "properties": {
                        "seed_id": { "type": "string" },
                        "reason": { "type": "string" }
                      }
                    }
                  },
                  "follow_up_question": { "type": "string" },
                  "reasoning": { "type": "string" }
                }
              }
            }
          }
        ]
      },
      "error_response_schema": { "$ref": "#/definitions/ErrorEnvelope" }
    },
    "EP-01": {
      "path": "/api/v1/edge-pod/ai/01/classification",
      "method": "POST",
      "request_schema": {
        "allOf": [
          { "$ref": "#/definitions/BaseRequest" },
          {
            "type": "object",
            "required": ["text", "seed_candidate_id"],
            "properties": {
              "text": { "type": "string", "minLength": 1 },
              "seed_candidate_id": { "type": "string", "minLength": 1 },
              "location": { "$ref": "#/definitions/GeoPoint" },
              "conversation_context": { "type": "object", "additionalProperties": true },
              "suggested_track": { "type": "string" },
              "seed_type_hint": { "type": "string" }
            }
          }
        ]
      },
      "success_response_schema": {
        "allOf": [
          { "$ref": "#/definitions/SuccessEnvelope" },
          {
            "required": ["output"],
            "properties": {
              "manual_required": { "type": "boolean" },
              "output": {
                "type": "object",
                "required": [
                  "track",
                  "track_confidence",
                  "seed_type",
                  "seed_confidence",
                  "ambiguity_flag"
                ],
                "properties": {
                  "track": { "type": "string" },
                  "track_confidence": { "type": "number", "minimum": 0, "maximum": 1 },
                  "seed_type": { "type": "string" },
                  "seed_confidence": { "type": "number", "minimum": 0, "maximum": 1 },
                  "esco_skills": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "required": ["uri", "score"],
                      "properties": {
                        "uri": { "type": "string" },
                        "score": { "type": "number", "minimum": 0, "maximum": 1 }
                      }
                    }
                  },
                  "ambiguity_flag": { "type": "boolean" },
                  "alternative_track": { "type": "string" },
                  "alternative_confidence": { "type": "number", "minimum": 0, "maximum": 1 },
                  "reasoning": { "type": "string" }
                }
              }
            }
          }
        ]
      },
      "error_response_schema": { "$ref": "#/definitions/ErrorEnvelope" }
    },
    "EP-02": {
      "path": "/api/v1/edge-pod/ai/02/redaction",
      "method": "POST",
      "request_schema": {
        "allOf": [
          { "$ref": "#/definitions/BaseRequest" },
          {
            "type": "object",
            "required": ["text", "text_format", "user_id", "context_summary"],
            "properties": {
              "text": { "type": "string", "minLength": 1 },
              "text_format": { "type": "string", "enum": ["plain", "markdown"] },
              "user_id": { "type": "string", "minLength": 1 },
              "context_summary": { "type": "string", "minLength": 1 },
              "privacy_level": {
                "type": "string",
                "enum": ["open", "l1", "l2", "vault"]
              },
              "allow_redaction": { "type": "boolean" }
            }
          }
        ]
      },
      "success_response_schema": {
        "allOf": [
          { "$ref": "#/definitions/SuccessEnvelope" },
          {
            "required": ["output"],
            "properties": {
              "output": {
                "type": "object",
                "required": ["redacted_text", "redaction_count", "needs_manual_review"],
                "properties": {
                  "redacted_text": { "type": "string" },
                  "redaction_count": { "type": "integer", "minimum": 0 },
                  "redacted_items": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "required": ["kind", "start", "end", "value"],
                      "properties": {
                        "kind": { "type": "string" },
                        "start": { "type": "integer", "minimum": 0 },
                        "end": { "type": "integer", "minimum": 1 },
                        "value": { "type": "string" }
                      },
                      "additionalProperties": false
                    }
                  },
                  "needs_manual_review": { "type": "boolean" },
                  "reason_code": { "type": "string" }
                }
              }
            }
          }
        ]
      },
      "error_response_schema": { "$ref": "#/definitions/ErrorEnvelope" }
    },
    "EP-03": {
      "path": "/api/v1/edge-pod/ai/03/duplicate-detection",
      "method": "POST",
      "prompt_id": "DUPLICATE-001",
      "prompt_source": "14-prompt-versioning.md",
      "prompt_version": "v0.2.0",
      "request_schema": {
        "allOf": [
          { "$ref": "#/definitions/BaseRequest" },
          {
            "type": "object",
            "required": ["seed_text"],
            "properties": {
              "seed_text": { "type": "string", "minLength": 1 },
              "media_hashes": { "type": "array", "items": { "type": "string" } },
              "embedding": {
                "type": "array",
                "items": { "type": "number" },
                "minItems": 1
              },
              "location": { "$ref": "#/definitions/GeoPoint" },
              "radius_km": { "type": "number", "minimum": 0 },
              "scope": { "type": "string" },
              "exclude_seed_ids": { "type": "array", "items": { "type": "string" } },
              "query_options": { "type": "object", "additionalProperties": true }
            }
          }
        ]
      },
      "success_response_schema": {
        "allOf": [
          { "$ref": "#/definitions/SuccessEnvelope" },
          {
            "required": ["output"],
            "properties": {
              "output": {
                "type": "object",
                "required": ["matches", "top_match", "confidence", "auto_block"],
                "properties": {
                  "matches": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "required": ["seed_id", "similarity", "distance_km", "recommendation"],
                      "properties": {
                        "seed_id": { "type": "string" },
                        "similarity": { "type": "number", "minimum": 0, "maximum": 1 },
                        "distance_km": { "type": "number", "minimum": 0 },
                        "recommendation": {
                          "type": "string",
                          "enum": ["allow", "warn", "block"]
                        }
                      }
                    }
                  },
                  "top_match": { "type": "string" },
                  "confidence": { "type": "number", "minimum": 0, "maximum": 1 },
                  "auto_block": { "type": "boolean" }
                }
              }
            }
          }
        ]
      },
      "error_response_schema": { "$ref": "#/definitions/ErrorEnvelope" }
    },
    "EP-04": {
      "path": "/api/v1/edge-pod/ai/04/moderation",
      "method": "POST",
      "request_schema": {
        "allOf": [
          { "$ref": "#/definitions/BaseRequest" },
          {
            "type": "object",
            "required": ["content_id", "text"],
            "properties": {
              "content_id": { "type": "string", "minLength": 1 },
              "text": { "type": "string", "minLength": 1 },
              "attachments": { "type": "array", "items": { "type": "string" } },
              "author_id": { "type": "string" },
              "author_reputation": { "type": "number" },
              "track": { "type": "string" },
              "seed_type": { "type": "string" },
              "location": { "$ref": "#/definitions/GeoPoint" },
              "report_volume": { "type": "integer", "minimum": 0 }
            }
          }
        ]
      },
      "success_response_schema": {
        "allOf": [
          { "$ref": "#/definitions/SuccessEnvelope" },
          {
            "required": ["output"],
            "properties": {
              "output": {
                "type": "object",
                "required": ["status", "action", "hold_duration_minutes"],
                "properties": {
                  "status": {
                    "type": "string",
                    "enum": ["ok", "hold", "block", "escalate"]
                  },
                  "violations": { "type": "array", "items": { "type": "string" } },
                  "action": {
                    "type": "string",
                    "enum": ["publish", "hold", "remove", "review", "queue_review"]
                  },
                  "hold_duration_minutes": { "type": "integer", "minimum": 0 },
                  "auto_release_if_no_action": { "type": "boolean" },
                  "reason_code": { "type": "string" },
                  "reasoning": { "type": "string" }
                }
              }
            }
          }
        ]
      },
      "error_response_schema": { "$ref": "#/definitions/ErrorEnvelope" }
    },
    "EP-05": {
      "path": "/api/v1/edge-pod/ai/05/gaming-risk",
      "method": "POST",
      "prompt_id": "GAMING-001",
      "prompt_source": "14-prompt-versioning.md",
      "prompt_version": "v0.2.0",
      "request_schema": {
        "allOf": [
          { "$ref": "#/definitions/BaseRequest" },
          {
            "type": "object",
            "required": ["query_users", "lookback_hours", "platform"],
            "properties": {
              "query_users": {
                "type": "array",
                "items": { "type": "string" },
                "minItems": 1
              },
              "seed_ids": { "type": "array", "items": { "type": "string" } },
              "focus_metric": {
                "type": "string",
                "enum": ["posting_rate", "vouch_rate", "revenue", "dispute", "generic"]
              },
              "lookback_hours": { "type": "integer", "minimum": 1 },
              "platform": { "type": "string", "minLength": 1 },
              "window_start": { "type": "string", "format": "date-time" },
              "window_end": { "type": "string", "format": "date-time" }
            }
          }
        ]
      },
      "success_response_schema": {
        "allOf": [
          { "$ref": "#/definitions/SuccessEnvelope" },
          {
            "required": ["output"],
            "properties": {
              "output": {
                "type": "object",
                "required": ["flags", "summary", "recommendation"],
                "properties": {
                  "flags": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "required": ["user_id", "metric", "flag", "reason_code", "severity"],
                      "properties": {
                        "user_id": { "type": "string" },
                        "metric": { "type": "string" },
                        "flag": { "type": "boolean" },
                        "reason_code": { "type": "string" },
                        "severity": {
                          "type": "string",
                          "enum": ["low", "medium", "high"]
                        }
                      }
                    }
                  },
                  "summary": {
                    "type": "object",
                    "required": ["total_flags", "critical_count"],
                    "properties": {
                      "total_flags": { "type": "integer", "minimum": 0 },
                      "critical_count": { "type": "integer", "minimum": 0 }
                    }
                  },
                  "recommendation": {
                    "type": "string",
                    "enum": ["none", "manual_review", "slow_mode", "suspend_actions"]
                  }
                }
              }
            }
          }
        ]
      },
      "error_response_schema": { "$ref": "#/definitions/ErrorEnvelope" }
    },
    "EP-06": {
      "path": "/api/v1/edge-pod/ai/06/criteria-suggestions",
      "method": "POST",
      "request_schema": {
        "allOf": [
          { "$ref": "#/definitions/BaseRequest" },
          {
            "type": "object",
            "required": ["seed_id", "track", "seed_text"],
            "properties": {
              "seed_id": { "type": "string", "minLength": 1 },
              "track": { "type": "string", "minLength": 1 },
              "seed_text": { "type": "string", "minLength": 1 },
              "discussion_summary": { "type": "string" },
              "community_context": { "type": "object", "additionalProperties": true },
              "policy_scope": { "type": "string" }
            }
          }
        ]
      },
      "success_response_schema": {
        "allOf": [
          { "$ref": "#/definitions/SuccessEnvelope" },
          {
            "required": ["output"],
            "properties": {
              "output": {
                "type": "object",
                "required": ["suggested_criteria", "suggested_tasks", "task_decomposition_confidence"],
                "properties": {
                  "suggested_criteria": {
                    "type": "array",
                    "items": { "type": "string" }
                  },
                  "suggested_tasks": { "type": "array", "items": { "type": "string" } },
                  "task_decomposition_confidence": {
                    "type": "number",
                    "minimum": 0,
                    "maximum": 1
                  },
                  "user_agency_note": { "type": "string" }
                }
              }
            }
          }
        ]
      },
      "error_response_schema": { "$ref": "#/definitions/ErrorEnvelope" }
    },
    "EP-07": {
      "path": "/api/v1/edge-pod/ai/07/summary",
      "method": "POST",
      "request_schema": {
        "allOf": [
          { "$ref": "#/definitions/BaseRequest" },
          {
            "type": "object",
            "required": ["input_texts", "messages", "window_start", "window_end"],
            "properties": {
              "input_texts": { "type": "array", "items": { "type": "string" } },
              "messages": {
                "type": "array",
                "items": { "type": "object", "additionalProperties": true }
              },
              "scope": { "type": "string" },
              "filters": { "type": "object", "additionalProperties": true },
              "window_start": { "type": "string", "format": "date-time" },
              "window_end": { "type": "string", "format": "date-time" },
              "max_items": { "type": "integer", "minimum": 1 }
            }
          }
        ]
      },
      "success_response_schema": {
        "allOf": [
          { "$ref": "#/definitions/SuccessEnvelope" },
          {
            "required": ["output"],
            "properties": {
              "output": {
                "type": "object",
                "required": ["summary", "key_points"],
                "properties": {
                  "summary": { "type": "string" },
                  "key_points": { "type": "array", "items": { "type": "string" } },
                  "sentiment": {
                    "type": "string",
                    "enum": ["positive", "neutral", "negative", "mixed"]
                  },
                  "action_items": { "type": "array", "items": { "type": "string" } },
                  "controversies": { "type": "array", "items": { "type": "string" } },
                  "clusters": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "label": { "type": "string" },
                        "count": { "type": "integer", "minimum": 0 }
                      }
                    }
                  },
                  "raw_items": { "type": "boolean" }
                }
              }
            }
          }
        ]
      },
      "error_response_schema": { "$ref": "#/definitions/ErrorEnvelope" }
    },
    "EP-08": {
      "path": "/api/v1/edge-pod/ai/08/sensitive-media",
      "method": "POST",
      "prompt_id": "SENSITIVE-001",
      "prompt_source": "14-prompt-versioning.md",
      "prompt_version": "v0.2.0",
      "request_schema": {
        "allOf": [
          { "$ref": "#/definitions/BaseRequest" },
          {
            "type": "object",
            "required": ["media_urls", "media_types", "seed_id", "author_id", "seed_text"],
            "properties": {
              "media_urls": {
                "type": "array",
                "items": { "type": "string", "format": "uri" }
              },
              "media_types": {
                "type": "array",
                "items": { "type": "string" },
                "minItems": 1
              },
              "seed_id": { "type": "string", "minLength": 1 },
              "author_id": { "type": "string", "minLength": 1 },
              "seed_text": { "type": "string", "minLength": 1 },
              "hash_chain": { "type": "array", "items": { "type": "string" } }
            }
          }
        ]
      },
      "success_response_schema": {
        "allOf": [
          { "$ref": "#/definitions/SuccessEnvelope" },
          {
            "required": ["output"],
            "properties": {
              "output": {
                "type": "object",
                "required": ["scans", "overall_safety"],
                "properties": {
                  "scans": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "required": ["media_url", "detections", "severity", "score"],
                      "properties": {
                        "media_url": { "type": "string" },
                        "detections": {
                          "type": "array",
                          "items": { "type": "string" }
                        },
                        "severity": {
                          "type": "string",
                          "enum": ["low", "medium", "high"]
                        },
                        "score": { "type": "number", "minimum": 0, "maximum": 1 }
                      }
                    }
                  },
                  "overall_safety": {
                    "type": "string",
                    "enum": ["safe", "review", "unsafe"]
                  },
                  "redacted_media_url": { "type": "string" },
                  "summary": { "type": "string" },
                  "is_actionable": { "type": "boolean" }
                }
              }
            }
          }
        ]
      },
      "error_response_schema": { "$ref": "#/definitions/ErrorEnvelope" }
    },
    "EP-09": {
      "path": "/api/v1/edge-pod/ai/09/credit-recommendation",
      "method": "POST",
      "prompt_id": "CREDIT-001",
      "prompt_source": "14-prompt-versioning.md",
      "prompt_version": "v0.2.0",
      "request_schema": {
        "allOf": [
          { "$ref": "#/definitions/BaseRequest" },
          {
            "type": "object",
            "required": ["user_id", "timeline_events", "skill_profile"],
            "properties": {
              "user_id": { "type": "string", "minLength": 1 },
              "timeline_events": {
                "type": "array",
                "items": { "type": "object", "additionalProperties": true }
              },
              "contrib_events": {
                "type": "array",
                "items": { "type": "object", "additionalProperties": true }
              },
              "skill_profile": { "type": "array", "items": { "type": "string" } },
              "reputation_snapshot": { "type": "object", "additionalProperties": true }
            }
          }
        ]
      },
      "success_response_schema": {
        "allOf": [
          { "$ref": "#/definitions/SuccessEnvelope" },
          {
            "required": ["output"],
            "properties": {
              "output": {
                "type": "object",
                "required": ["candidate_allocations", "dispute_window", "confidence_source"],
                "properties": {
                  "candidate_allocations": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "required": ["candidate_id", "type", "weight"],
                      "properties": {
                        "candidate_id": { "type": "string" },
                        "type": { "type": "string" },
                        "weight": { "type": "number", "minimum": 0, "maximum": 1 }
                      }
                    }
                  },
                  "confidence": { "type": "number", "minimum": 0, "maximum": 1 },
                  "reasoning": { "type": "string" },
                  "dispute_window": {
                    "type": "string",
                    "enum": ["minutes", "hours", "days"]
                  },
                  "confidence_source": { "type": "string" }
                }
              }
            }
          }
        ]
      },
      "error_response_schema": { "$ref": "#/definitions/ErrorEnvelope" }
    },
    "EP-10": {
      "path": "/api/v1/edge-pod/ai/10/skill-extract",
      "method": "POST",
      "request_schema": {
        "allOf": [
          { "$ref": "#/definitions/BaseRequest" },
          {
            "type": "object",
            "required": ["text", "language", "seed_context", "existing_skills"],
            "properties": {
              "text": { "type": "string", "minLength": 1 },
              "language": { "type": "string", "minLength": 1 },
              "seed_context": { "type": "string" },
              "existing_skills": { "type": "array", "items": { "type": "string" } },
              "self_declared": { "type": "array", "items": { "type": "string" } }
            }
          }
        ]
      },
      "success_response_schema": {
        "allOf": [
          { "$ref": "#/definitions/SuccessEnvelope" },
          {
            "required": ["output"],
            "properties": {
              "output": {
                "type": "object",
                "required": ["esco_skills"],
                "properties": {
                  "esco_skills": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "required": ["uri", "score", "validated"],
                      "properties": {
                        "uri": { "type": "string" },
                        "score": { "type": "number", "minimum": 0, "maximum": 1 },
                        "source": { "type": "string" },
                        "validated": { "type": "boolean" }
                      }
                    }
                  }
                }
              }
            }
          }
        ]
      },
      "error_response_schema": { "$ref": "#/definitions/ErrorEnvelope" }
    },
    "EP-11": {
      "path": "/api/v1/edge-pod/ai/siaga/evaluate",
      "method": "POST",
      "request_schema": {
        "allOf": [
          { "$ref": "#/definitions/BaseRequest" },
          {
            "type": "object",
            "required": ["text", "location", "current_track", "reported_urgency", "community_scope"],
            "properties": {
              "location": { "$ref": "#/definitions/GeoPoint" },
              "confidence_bundle": { "type": "object", "additionalProperties": true },
              "reported_urgency": {
                "type": "string",
                "enum": ["low", "normal", "high", "critical"]
              },
              "community_scope": { "type": "string", "minLength": 1 },
              "current_track": { "type": "string", "minLength": 1 }
            }
          }
        ]
      },
      "success_response_schema": {
        "allOf": [
          { "$ref": "#/definitions/SuccessEnvelope" },
          {
            "required": ["output"],
            "properties": {
              "output": {
                "type": "object",
                "required": [
                  "is_siaga",
                  "severity",
                  "responder_payload",
                  "scope",
                  "timeline_window",
                  "override_policy"
                ],
                "properties": {
                  "is_siaga": { "type": "boolean" },
                  "severity": {
                    "type": "string",
                    "enum": ["low", "medium", "high", "critical"]
                  },
                  "responder_payload": {
                    "type": "object",
                    "required": ["channels", "template"],
                    "properties": {
                      "channels": {
                        "type": "array",
                        "items": { "type": "string" }
                      },
                      "template": { "type": "string" },
                      "estimated_reach": { "type": "integer", "minimum": 0 }
                    }
                  },
                  "scope": { "type": "string" },
                  "timeline_window": { "type": "string" },
                  "override_policy": {
                    "type": "string",
                    "enum": ["human_only", "auto_if_threshold", "manual_approve_only"]
                  },
                  "confidence": { "type": "number", "minimum": 0, "maximum": 1 }
                }
              }
            }
          }
        ]
      },
      "error_response_schema": { "$ref": "#/definitions/ErrorEnvelope" }
    }
  }
}
