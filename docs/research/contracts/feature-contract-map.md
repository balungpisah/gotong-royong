# Feature to Contract Map (Research Phase 1)

This file links each UI feature to:
- required backend capability,
- exact contract source(s),
- trigger,
- and status (`KNOWN`, `PARTIAL`, `UNKNOWN`).

## Mapping table

| Feature ID | Backend capability | Contract source(s) | Request/Output contract | Trigger | Ownership | Status |
|---|---|---|---|---|---|---|
| UI-01 | Start triage session and create conversation draft | `docs/design/specs/ui-ux-spec/20-bagikan-create-flow.md`<br/>`docs/design/specs/ai-spec/04-ai-00-triage.md`<br/>`docs/design/specs/AI-SPEC-v0.2.md` | triage session create payload, context bar state transitions, triage transcript, handoff to seed draft | user taps `+` / starts first message | shared | PARTIAL |
| UI-02 | Persist/override classification result | `docs/design/specs/ai-spec/05-ai-01-classification.md`<br/>`docs/design/specs/ui-ux-spec/20-bagikan-create-flow.md` | `track`, `seed_type`, `esco_skills`, confidence, ambiguity flag, `manual_override=false/true`, reason code, user_id/session_id, audit metadata | AI-00 ready/leaning/manual transitions; user taps `Ubah`/`Pilih sendiri` | shared | PARTIAL |
| UI-03 | Track workflow transitions and state history | `docs/design/specs/ui-ux-spec/03-track-architecture.md`<br/>`docs/design/specs/ui-ux-spec/04-adaptive-phase-patterns.md`<br/>`docs/design/specs/ui-ux-spec/13-transitions-and-quorum.md`<br/>`docs/design/context/TRACK-MAP.md`<br/>`docs/design/backend-design-contract-gotong-tandang.md` | track transition record (`track_state_transition`) with idempotency `request_id`; roles, gate, timer fields, event replay metadata | stage action, timer expiry, consent window events | app-only + internal event log | KNOWN |
| UI-04 | Evidence upload and PoR validation | `docs/design/specs/ui-ux-spec/09-evidence-triad.md`<br/>`docs/por-evidence/evidence-format.md`<br/>`docs/api/event-payloads.md`<br/>`[tandang]docs/GOTONG-ROYONG-INTEGRATION-GUIDE.md` | `POST /platforms/gotong_royong/webhook` with `por_evidence`; proof fields (`media_hash`, `timestamp`, `location`, `witnesses`), validation result, contribution_id mapping | user submits completion / verifier attaches proof | shared | PARTIAL |
| UI-05 | Vouch submission and storage | `docs/design/specs/ui-ux-spec/14-reputation-ui-contract.md`<br/>`docs/api/event-payloads.md`<br/>`[tandang]docs/GOTONG-ROYONG-INTEGRATION-GUIDE.md` | `vouch_submitted` payload, optional `weight_hint`, message, duplicate guard, anti-spam rejection reason, moderation risk score | user taps `Jaminkan` | shared | KNOWN |
| UI-06 | Reputation and tier readback | `docs/design/specs/ui-ux-spec/14-reputation-ui-contract.md`<br/>`[tandang]crates/api/src/routes/users/mod.rs`<br/>`[tandang]crates/api/src/dto/user.rs` | `GET /api/v1/users/{platform_user_id}/reputation` response (`user_id`,`tier`,`integrity`,`judgment`,`competences`,`total_reputation`,`vouch_weight_multiplier`) with cache headers | page open / periodic refresh | Tandang-owned | PARTIAL |
| UI-07 | Moderation state machine + visibility rules | `docs/design/specs/ai-spec/08-ai-04-content-moderation.md`<br/>`docs/design/specs/ai-spec/18-guardrails.md`<br/>`docs/design/specs/ui-ux-spec/15-privacy-and-safety.md`<br/>`docs/design/backend-design-contract-gotong-tandang.md` | moderation output contract (`status`, `violations`, `confidence`, `action`, `reason`, `auto_release_if_no_action`, timestamp) and public/author/moderator views | AI-04 hold/block event; user report; moderator action | app-owned moderation state, persisted in Gotong DB | KNOWN |
| UI-08 | Siaga high-priority broadcast | `docs/design/specs/ui-ux-spec/25-siaga-broadcast.md`<br/>`docs/design/specs/ui-ux-spec/06-cross-cutting-capabilities.md`<br/>`docs/design/specs/ai-spec/04-ai-00-triage.md`<br/>`docs/design/backend-design-contract-gotong-tandang.md` | siaga event object, responder join token, emergency timeline milestones, escalation and closure fields; append-only timeline | AI-00 siaga-ready state; user taps `Siarkan Sekarang`; timeout fallback | app-only | KNOWN |
| UI-09 | Catatan Saksi privacy lifecycle | `docs/design/specs/ui-ux-spec/24-catatan-saksi.md`<br/>`docs/design/prototypes/C4-catatan-saksi-feed.html`<br/>`docs/design/backend-design-contract-gotong-tandang.md` | encrypted write payload, seal state transitions (`draft`→`sealed`→`published`), visibility exceptions, retention timer, audit hash; tombstone retention | user enters vault / seals / publishes | app-only (sealed hash tombstone metadata only persisted) | KNOWN |
| UI-10 | Feed/home feed and scope filtering | `docs/design/specs/ui-ux-spec/26-navigation-and-feed.md`<br/>`docs/design/prototypes/C3-navigation-feed.html`<br/>`docs/design/backend-design-contract-gotong-tandang.md` | feed query contract (`scope_id`, `track_filter`, `q`, `sort`, `cursor`, `limit`, unread_count), response ordering and role-specific filtering; cursor model | tab switch, scope picker, pagination | app-only (treat Tandang as read-only input for reputation/rank) | KNOWN |
| UI-11 | Search overlay | `docs/design/specs/ui-ux-spec/26-navigation-and-feed.md`<br/>`docs/design/backend-design-contract-gotong-tandang.md` | search query contract with filters and ranking window; returned entity projection, privacy redaction for secret entities | user submits query | app-only (Tandang provides reputation/ranking hints) | KNOWN |
| UI-12 | Notifications + weekly digest | `docs/design/specs/ui-ux-spec/26-navigation-and-feed.md`<br/>`docs/design/specs/ui-ux-spec/06-cross-cutting-capabilities.md`<br/>`docs/design/backend-design-contract-gotong-tandang.md` | event fan-out payload, unread counter, read_at updates, digest assembly input (`user_id`, `window_start`,`window_end`), exclude-rules | event emission, scheduler tick, app foreground | app-only | KNOWN |
| UI-13 | ESCO skills surfaces and validation state | `docs/design/specs/ui-ux-spec/30-esco-skills.md` | extraction response (`skill_uri`, `score`, `source`, `validated`) plus decay and mismatch flags | seed submit, profile add/edit, open card view | Tandang-owned (skills) | PARTIAL |
| UI-14 | Onboarding and membership | `docs/design/specs/ui-ux-spec/19-onboarding-and-membership.md` | OTP challenge lifecycle, membership scope claim, authority registration state, invite code validation and expiry | first run, OTP validation event, invite join actions | shared | PARTIAL |
| UI-15 | Share sheet + invite workflow | `docs/design/specs/ui-ux-spec/26-navigation-and-feed.md`<br/>`docs/design/prototypes/C6-share-sheet.html` | share payload object (entity_id, target_scope, embed_type), invite QR token, embargo policy | user taps share/invite action | shared | PARTIAL |
| UI-16 | Rutin recurring | `docs/design/specs/ui-ux-spec/18-rutin-deep-ux.md`<br/>`docs/design/specs/ui-ux-spec/06-cross-cutting-capabilities.md` | recurrence rule (`cron`/`interval`/`day_of_week`), spawn parent/child links, skip/cancel actions, rotation metadata | user configures rutin; scheduled cron events | shared | PARTIAL |
| UI-17 | Governance voting and quorum | `docs/design/specs/ui-ux-spec/07-governance-voting.md`<br/>`docs/design/specs/ui-ux-spec/05-bahas-decision.md` | vote action payload, weighted tally snapshot, quorum thresholds, immutable vote records, winner calculation proof | proposal create, vote start, vote close | shared | PARTIAL |
| UI-18 | Roles and permissions lifecycle | `docs/design/specs/ui-ux-spec/08-roles.md`<br/>`docs/design/specs/ui-ux-spec/21-roles-and-permissions.md` | role assignment payload (`actor_id`,`role`,`eligibility`,`term_start`,`term_end`), role revocation, permission matrix responses | nomination, auto-selection, nomination expiry | shared | PARTIAL |
| UI-19 | Dispute and stochastic jury | `docs/design/specs/ui-ux-spec/22-dispute-and-jury.md`<br/>`docs/design/specs/ai-spec/09-ai-05-gaming-detection.md` | dispute report object, jury assignment algorithm seed, evidence bundle, verdict options, appeal metadata | user files dispute/report; jury selection timer | shared | PARTIAL |
| UI-20 | LLM ↔ UI diff and source tags | `docs/design/specs/ui-ux-spec/29-llm-architecture.md`<br/>`docs/design/specs/ui-ux-spec/23-ai-layer-cross-reference.md` | source_tag block contract (`ai|human|system`, protected flag, patch op, apply/rollback action), lock semantics, conflict resolution trace | AI suggestion appears; user edits/applies/rejects | shared | PARTIAL |
| UI-21 | Galang (fundraising ledger) | `docs/design/specs/ui-ux-spec/17-galang-deep-ux.md`<br/>`docs/design/specs/ui-ux-spec/06-cross-cutting-capabilities.md` | contribution transaction item, audit entry, freeze/rollback reason, media attachment references, donor role checks | seed enters Galang; Bendahara updates target/balance | shared | PARTIAL |
| UI-22 | Siarkan (broadcast/amplify) | `docs/design/specs/ui-ux-spec/06-cross-cutting-capabilities.md`<br/>`docs/design/specs/ui-ux-spec/08-roles.md` | campaign content contract, reach counters, media kit references, role checks, scheduling/expiry | track enters Siarkan / Humas posts update | shared | PARTIAL |
| UI-23 | Duplicate detection + merge resolution | `docs/design/specs/ai-spec/07-ai-03-duplicate-detection.md`<br/>`docs/design/specs/ai-spec/04-ai-00-triage.md` | similarity match set (`seed_id`,`similarity`,`distance_km`,`recommendation`), threshold metadata, merged_into reference, audit reason | triage pill and submit confirmation | shared | PARTIAL |

## Unknown-to-resolve actions

1. Confirm approver sign-off for resolved `UI-03`/`UI-07`/`UI-08`/`UI-09` decisions and record exact timestamps.
2. Confirm exact endpoint names for `UI-10`..`UI-12` feed/search/notification APIs and pagination contract (`cursor`, `limit`, privacy filters).
3. Add per-feature schema examples in `tandang-gap-log.md`.
